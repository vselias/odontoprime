<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">


<h:form id="frmDetalheFechamento">

	<h3>Consulta(s) paga(s) hoje.</h3>
	
	<center>
		<p:dataTable widgetVar="tblConsulta" styleClass="tabela"
			tableStyle="width:auto" resizableColumns="true" paginator="true"
			rowsPerPageTemplate="5,10,15" reflow="true" rowKey="#{c.id}"
			selectionMode="single" selection="#{consultaMB.consulta}"
			value="#{movimentacaoCaixaMB.consultasFechamento}" id="tblConsulta"
			var="c" rows="5" paginatorPosition="top"
			emptyMessage="Nenhum registro.">


			<p:column style="text-align:center;" headerText="Foto">
				<p:graphicImage cache="false" width="80px;" height="80px;"
					rendered="#{c.paciente.nomeImagem eq null or c.paciente.nomeImagem eq ''}"
					value="/img/new-user.png" />
				<p:graphicImage cache="false" width="80px;" height="80px;"
					rendered="#{c.paciente.nomeImagem ne null and c.paciente.nomeImagem ne ''}"
					value="/imagens/#{c.paciente.nomeImagem}" />
			</p:column>


			<p:column filterBy="#{c.paciente.nome}" sortBy="#{c.paciente.nome}"
				headerText="Paciente">
				<p:outputLabel value="#{c.paciente.nome}" />
			</p:column>


			<p:column headerText="Consulta" filterBy="#{c.tipoConsulta}"
				sortBy="#{c.tipoConsulta}">
				<p:outputLabel value="#{c.tipoConsulta.descricao}" />

			</p:column>

			<p:column filterMatchMode="startsWith" filterBy="#{c.dataConsulta}"
				sortBy="#{c.dataConsulta}" headerText="Data">
				<p:outputLabel value="#{c.dataConsulta}">
					<f:convertDateTime timeZone="America/Sao_Paulo"
						pattern="dd/MM/yyyy HH:mm:ss" locale="pt_BR" />
				</p:outputLabel>
			</p:column>

			<p:column sortBy="#{c.estadoConsulta.descricao}"
				filterBy="#{c.estadoConsulta.descricao}" headerText="Estado">

				<p:outputLabel value="#{c.estadoConsulta.descricao}" />
			</p:column>
			<p:column filterBy="#{c.entrada.valor}" sortBy="#{c.entrada.valor}"
				headerText="Valor">
				<p:outputLabel value="#{c.entrada.valor}">
					<f:convertNumber pattern="R$ #,##0.00" />
				</p:outputLabel>
				<p:outputLabel rendered="#{c.entrada.valor eq null}" value="R$ 0,00" />
			</p:column>
			<p:column filterBy="#{c.entrada.desconto}"
				sortBy="#{c.entrada.desconto}" headerText="Desconto">
				<p:outputLabel rendered="#{c.entrada.desconto ne null}"
					value="#{c.entrada.desconto}%" />
				<p:outputLabel rendered="#{c.entrada.desconto eq null}" value="0" />
			</p:column>

			<p:column filterBy="#{c.entrada.valorComDesconto}"
				sortBy="#{c.entrada.valorComDesconto}" headerText="Total">

				<p:outputLabel value="#{c.entrada.valorComDesconto}">
					<f:convertNumber pattern="R$ #,##0.00" />
				</p:outputLabel>

				<p:outputLabel rendered="#{c.entrada.valorComDesconto eq null}"
					value="R$ 0,00" />
			</p:column>

			<p:column>
				<p:commandButton icon="fa fa-check" oncomplete="PF('dlgExbParcela').show();"
					update=":frmExbParcela"
					action="#{movimentacaoCaixaMB.buscarEntradaComParcela(c.entrada)}"
					value="Ver pagamentos" />

			</p:column>
			<f:facet name="footer">
				<p:outputLabel style="text-align:right"
					value="#{movimentacaoCaixaMB.movimentacaoCaixa.entrada}">
					<f:convertNumber pattern="Total + R$ #,##0.00" locale="pt_BR" />
				</p:outputLabel>
			</f:facet>
		</p:dataTable>
	</center>

	<h3>Saída(s) realizada(s) hoje.</h3>

	<center>
		<p:dataTable tableStyle="width:auto" resizableColumns="true"
			widgetVar="tabela" styleClass="tabela" paginator="true"
			rowsPerPageLabel="5,10,15" rowKey="#{s.id}"
			selection="#{movimentacaoCaixaMB.selecaoSaidaFechamento}"
			selectionMode="single"
			value="#{movimentacaoCaixaMB.saidasFechamento}" id="tabela" rows="5"
			emptyMessage="Nenhum registro." var="s">

			<p:column style="text-align:center;" sortBy="#{s.item}"
				filterBy="#{s.item}">
				<f:facet name="header">
					<h:outputText value="Usuario" />
				</f:facet>
				<p:graphicImage
					rendered="#{s.usuario eq null or s.usuario.nomeImagem eq null}"
					cache="false" width="100px" height="100px"
					value="/img/new-user.png" />
				<p:graphicImage
					rendered="#{s.usuario ne null and s.usuario.nomeImagem ne null}"
					cache="false" width="100px" height="100px"
					value="/imagens/#{s.usuario.nomeImagem}" />
			</p:column>

			<p:column sortBy="#{s.item}" filterBy="#{s.item}"
				headerText="Paciente">
				<f:facet name="header">
					<h:outputText value="Item" />
				</f:facet>
				<p:outputLabel value="#{s.item}" />
			</p:column>
			<p:column sortBy="#{s.motivo}" filterBy="#{s.motivo}"
				headerText="Motivo">
				<f:facet name="header">
					<h:outputText value="Motivo" />
				</f:facet>
				<p:outputLabel value="#{s.motivo}" />
			</p:column>
			<p:column sortBy="#{s.descricao}" filterBy="#{s.descricao}">
				<f:facet name="header">
					<h:outputText value="Descrição" />
				</f:facet>

				<p:outputLabel value="#{s.descricao}" />
			</p:column>

			<p:column sortBy="#{s.dataSaida}" filterBy="#{s.dataSaida}"
				headerText="Data">
				<f:facet name="header">
					<h:outputText value="Data" />
				</f:facet>
				<p:outputLabel value="#{s.dataSaida}">
					<f:convertDateTime locale="pt_BR" pattern="dd/MM/yyyy"
						timeZone="America/Sao_Paulo" />
				</p:outputLabel>
			</p:column>

			<p:column sortBy="#{s.quantidade}" filterBy="#{s.quantidade}"
				headerText="Valor">
				<f:facet name="header">
					<h:outputText value="Quantidade" />
				</f:facet>
				<p:outputLabel value="#{s.quantidade}" />
			</p:column>

			<p:column sortBy="#{s.valor}" filterBy="#{s.valor}"
				headerText="Valor">
				<f:facet name="header">
					<h:outputText value="Valor" />
				</f:facet>
				<p:outputLabel value="#{s.valor}">
					<f:convertNumber pattern="R$ #,##0.00" locale="pt_BR" />
				</p:outputLabel>
			</p:column>

			<f:facet name="footer">
				<p:outputLabel style="text-align:right;"
					value="#{movimentacaoCaixaMB.movimentacaoCaixa.saida}">
					<f:convertNumber pattern="Total - R$ #,##0.00" locale="pt_BR" />
				</p:outputLabel>
			</f:facet>
		</p:dataTable>
	</center>



</h:form>

</html>